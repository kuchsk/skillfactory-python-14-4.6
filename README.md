Задание по Python: очистка данных в pandas
Краткое описание задачи
Вам предоставлен файл test_data.csv. Исходный DataFrame:

Original DataFrame

Ваша задача — очистить данную таблицу от пропусков следующим образом:

Если признак имеет больше 50 % пропущенных значений, удалить его.
Для оставшихся данных: если в строке более двух пропусков, удалить строку.
Для оставшихся данных: числовые признаки заполнить средним значением, а категориальные — модой.
Пример решения задачи
Используя библиотеку pandas, мы можем легко решить данную задачу:



## задача — очистить данную таблицу от пропусков

## импортируем библиотеки
import pandas as pd
import numpy as np

## читаем файл
df = pd.read_csv('https://raw.githubusercontent.com/kuchsk/skillfactory-python-14-4.6/main/propuski.csv', sep = ';', index_col=False, )


# Если признак имеет больше 50 % пропущенных значений, удалите его.
df = df.dropna(thresh=df.shape[0]*0.5, axis =1 )

na_columns = na_count[na_count > len(df)/2].index
df = df.drop(columns=na_columns)

## Для оставшихся данных: если в строке более двух пропусков, удалите строку.
thresh2 = df.shape[1] - 2

## Для оставшихся данных: числовые признаки заполните средним значением, а категориальные — модой.

for i in df.columns: 
  if df[i].dtypes == 'int' or df[i].dtypes == 'float': 
    df[i].fillna(df[i].mean(), inplace=True) # среднее для числовых признаков 
  elif df[i].dtypes == 'object': 
    df[i].fillna(df[i].mode(), inplace=True) # мода значение для категориальных признаков
    
## Если даныые отличаются от категориальных или числовых, дабы избежать ошибок
  else: pass
  
## Вывод итогового DataFrame 
display(df)

## Выводы
Очистка данных — это важный и распространенный процесс при работе с данными. Библиотека pandas позволяет легко и быстро решать данную задачу с помощью набора методов для работы с пропущенными значениями. Основная идея состоит в том, чтобы удалить или заполнить пропуски с помощью статистических методов, чтобы сохранить максимальную информацию и минимизировать потери данных.


## 1. Второй порог тоже сделать расчетным: - разобраться...

thresh2 = df.shape[1] - 2
df = df.dropna(thresh = thresh2, axis = 0)

## В терминале skillfactory пропадает строка
6  0.241508  0.567744  1.200000  hist







import pandas as pd

# Чтение файла
df = pd.read_csv('test_data.csv')

# Определение количества пропусков
na_count = df.isna().sum()

# Определение признаков с более чем 50% пропущенных значений
na_columns = na_count[na_count > len(df)/2].index
df = df.drop(columns=na_columns)

# Удаление строк с более чем двумя пропусками
df = df.dropna(thresh=5)

# Заполнение числовых признаков средним значением
numeric_columns = df.select_dtypes(include='number').columns
df[numeric_columns] = df[numeric_columns].fillna(df[numeric_columns].mean())

# Заполнение категориальных признаков модой
categorical_columns = df.select_dtypes(exclude='number').columns
df[categorical_columns] = df[categorical_columns].fillna(df[categorical_columns].mode().iloc[0])

# Вывод итогового DataFrame
print(df)
Полученный DataFrame:

Cleaned DataFrame

Выводы
Очистка данных — это важный и распространенный процесс при работе с данными. Библиотека pandas позволяет легко и быстро решать данную задачу с помощью набора методов для работы с пропущенными значениями. Основная идея состоит в том, чтобы удалить или заполнить пропуски с помощью статистических методов, чтобы сохранить максимальную информацию и минимизировать потери данных.
